# Nexus: Inter-Widget Communication

Nexus is the system that allows widgets to interact with each other, creating a cohesive classroom ecosystem.

## Active Connections

### Random Picker -> Timer

**Description:** Automatically starts a timer when a student/winner is selected.
**Implementation:** `RandomWidget.tsx` checks for `autoStartTimer` config and triggers `updateWidget` on any active `time-tool` widget.
**Configuration:** Enabled via the "Auto-Start Timer" toggle in Random Widget settings (Single mode only).

### Random Picker -> Text Widget (History Log)

**Description:** Automatically appends the winner's name and a timestamp to the Text Widget (Notes) when a student is selected.
**Implementation:** `RandomWidget.tsx` checks for `logToNotes` config, finds the first `TextWidget`, and appends formatted HTML to its content.
**Configuration:** Enabled via the "Log History to Notes" toggle in Random Widget settings (Single mode only).

### Text Widget -> QR Widget (Link Repeater)

**Description:** Automatically generates a QR code for any link pasted into a text widget.
**Implementation:** `QRWidget.tsx` monitors the content of any active text widget and updates its URL if syncing is enabled.
**Configuration:** Enabled via the "Sync with Text Widget" toggle in QR Settings.

### Weather Widget -> Dashboard Background

**Description:** Automatically changes the dashboard background theme to match the current weather conditions (e.g., Blue gradient for Sunny, Dark gradient for Rainy).
**Implementation:** `WeatherWidget.tsx` monitors the `condition` state and calls `setBackground` on the dashboard context when `syncBackground` is enabled.
**Configuration:** Enabled via the "Sync Background" toggle in Weather Settings.

### Sound Widget -> Expectations (Auto-Sensitivity)

**Description:** Automatically adjusts the microphone sensitivity based on the current Voice Level set in the Expectations widget.
**Implementation:** `SoundWidget.tsx` monitors `activeDashboard.widgets` for `expectations` widget and updates `sensitivity` when `syncExpectations` is enabled.
**Configuration:** Enabled via "Sync with Expectations" in Sound Settings.

### Sound Widget -> Traffic Light (Auto-Control)

**Description:** Automatically triggers the Red Light on the Traffic Light widget when volume exceeds a threshold.
**Implementation:** `SoundWidget.tsx` monitors volume level and updates `traffic` widget state if `autoTrafficLight` is enabled.
**Configuration:** Enabled via "Auto-Control Traffic Light" in Sound Settings.

### Timer -> Expectations (End Action)

**Description:** Automatically sets the Voice Level to a specific level (e.g., 0 - Silence) when the timer reaches zero.
**Implementation:** `TimeToolWidget` (via `useTimeTool.ts`) updates `expectations` widget config when timer finishes if `timerEndVoiceLevel` is set.
**Configuration:** Configured in Time Tool Settings under "Timer End Action".

### Scoreboard -> Randomizer (Import)

**Description:** Allows importing groups generated by the Randomizer as teams in the Scoreboard.
**Implementation:** `ScoreboardSettings.tsx` reads `random` widget config `lastResult` and populates teams.
**Configuration:** Manual "Import Groups" button in Scoreboard Settings.

### Checklist -> Instructional Routines (Import)

**Description:** Allows importing steps from an Instructional Routine into the Checklist.
**Implementation:** `ChecklistSettings.tsx` reads `instructionalRoutines` widget config and populates checklist items.
**Configuration:** Manual "Sync" button in Checklist Settings.

## Planned Connections

- **Poll -> Text Widget:** Export poll results to notes.
- **Schedule -> Text Widget:** Export daily agenda to notes.
